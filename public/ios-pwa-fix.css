/**
 * iOS PWA Scroll Fix
 * Исправление rubber-band / overscroll bounce эффекта в Safari/iPhone PWA
 * + fix для зазора под bottom navbar (safe-area-inset-bottom)
 *
 * ВАЖНО: Все контейнеры используют inset:0 (top/bottom/left/right:0) вместо
 * явных viewport-юнитов (100dvh/100svh), т.к. эти юниты НЕ гарантированно
 * включают safe-area-inset-bottom на iOS PWA, и элемент заканчивается выше
 * нижнего края экрана → видна подложка браузера.
 */

/* Блокируем скролл на уровне документа */
html {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: hidden;
  width: 100%;
}

body {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  width: 100%;
  overflow: hidden;
  overscroll-behavior: none;
  overscroll-behavior-y: none;
  -webkit-overflow-scrolling: auto;
}

/* Фиксируем root контейнер */
#root {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: hidden;
}

/* Все прямые дочерние элементы root становятся scroll-контейнерами */
#root > div {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: none;
  overscroll-behavior-y: none;
}

/* iOS-специфичные стили */
@supports (-webkit-touch-callout: none) {
  body {
    -webkit-overflow-scrolling: auto;
  }

  #root > div {
    -webkit-overflow-scrolling: touch;
  }

  body {
    overscroll-behavior-y: none;
  }
}

/* ===== iOS PWA standalone: закрашиваем зону safe-area снизу ===== */
@media all and (display-mode: standalone) {
  body {
    background-color: var(--app-bg, #101122);
  }
}

/* Дополнительная защита для вложенных scroll-контейнеров */
.scroll-container,
[data-scroll-container] {
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: none;
}

#root {
  touch-action: pan-y;
}

#root > div {
  padding-bottom: 0 !important;
  margin-bottom: 0 !important;
}

/* Принудительно убираем нижний safe-area отступ на iOS PWA */
@supports (padding-bottom: env(safe-area-inset-bottom)) {
  html, body, #root, #root > div {
    padding-bottom: 0 !important;
  }
}
